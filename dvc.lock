schema: '2.0'
stages:
  structure_raw:
    cmd: python3 src/data/structure_raw.py
    deps:
    - path: data/raw/
      hash: md5
      md5: 6c3622ff98294a528208aece1e7ede8b.dir
      size: 21954635
      nfiles: 183
    - path: data/working_dataset.csv
      hash: md5
      md5: 02086bf6991f01344eccc4aba1935f1e
      size: 4542
    - path: dockers_started.txt
      hash: md5
      md5: cc72867581029d08025a87c527baf24e
      size: 29
    - path: params.yaml
      hash: md5
      md5: ba6f9bb53bbada055e556f582b04da9b
      size: 3407
    - path: src/data/structure_raw.py
      hash: md5
      md5: 222e1cd8e683fb3b9a0cd5ffc0dcf882
      size: 3431
    outs:
    - path: data/raw_per_classes/
      hash: md5
      md5: 2a253b9e215de4cfc035d2f33f94df26.dir
      size: 21840025
      nfiles: 181
  ingest:
    cmd: curl -X "POST" "http://etl-service/ingest"
    deps:
    - path: data/raw_per_classes/
      hash: md5
      md5: e287bf87092d098342775c0baa5908f0.dir
      size: 22147861
      nfiles: 185
    - path: params.yaml
      hash: md5
      md5: e8863fbdae4c02e9b337daf654ab891c
      size: 3870
    outs:
    - path: data/ocr_raw_per_classes/
      hash: md5
      md5: eb9e0d80716c9a8d0f12e6f8ffc40862.dir
      size: 176211
      nfiles: 185
  clean:
    cmd: curl -X "POST" "http://etl-service/clean"
    deps:
    - path: data/ocr_raw_per_classes/
      hash: md5
      md5: eb9e0d80716c9a8d0f12e6f8ffc40862.dir
      size: 176211
      nfiles: 185
    - path: params.yaml
      hash: md5
      md5: e8863fbdae4c02e9b337daf654ab891c
      size: 3870
    outs:
    - path: data/cleaned_per_classes/
      hash: md5
      md5: c70f5a3c337761012ca0ca4dcf59ab55.dir
      size: 114730
      nfiles: 3
  preprocessing:
    cmd: curl -X "POST" "http://preprocessing-service/process"
    deps:
    - path: data/cleaned_per_classes/
      hash: md5
      md5: c70f5a3c337761012ca0ca4dcf59ab55.dir
      size: 114730
      nfiles: 3
    - path: params.yaml
      hash: md5
      md5: e8863fbdae4c02e9b337daf654ab891c
      size: 3870
    outs:
    - path: data/processed
      hash: md5
      md5: 0cbb15bfcdd3e5d3ef7019325aab15dc.dir
      size: 3179450
      nfiles: 4
    - path: models/vectorizers
      hash: md5
      md5: b0aa0e95ffccd4772e1b167f28f7573e.dir
      size: 2527691
      nfiles: 1
  train:
    cmd: curl -X "POST" "http://train-service/train"
    deps:
    - path: data/processed/train
      hash: md5
      md5: 9366d0bee207199c4ff5f20251be0fca.dir
      size: 2671501
      nfiles: 2
    - path: params.yaml
      hash: md5
      md5: e8863fbdae4c02e9b337daf654ab891c
      size: 3870
    outs:
    - path: models/train
      hash: md5
      md5: 361c2da90e4702f79adb30afe566bff0.dir
      size: 1682517
      nfiles: 1
  eval:
    cmd: curl -X "POST" "http://eval-service/eval"
    deps:
    - path: data/processed/test
      hash: md5
      md5: 276b8ab8f09172d681ebe62168e754b8.dir
      size: 507949
      nfiles: 2
    - path: models/train
      hash: md5
      md5: 361c2da90e4702f79adb30afe566bff0.dir
      size: 1682517
      nfiles: 1
    - path: params.yaml
      hash: md5
      md5: e8863fbdae4c02e9b337daf654ab891c
      size: 3870
    outs:
    - path: metrics/confusion_matrix.json
      hash: md5
      md5: dff3ae253bf7391b8b073f54be0f0486
      size: 75
    - path: metrics/scores.json
      hash: md5
      md5: 54925ea035c4427fd3436bde7b75e51a
      size: 635
  env_mlops_sake:
    cmd: python3 src/config_transform_as_env.py && python src/smart_merge_.env_.env_mlops_sake.py
    deps:
    - path: params.yaml
      hash: md5
      md5: ba6f9bb53bbada055e556f582b04da9b
      size: 3407
    - path: src/config_transform_as_env.py
      hash: md5
      md5: d0ac128f1cc32185ebfd4bf959cf5c5f
      size: 3292
    - path: src/smart_merge_.env_.env_mlops_sake.py
      hash: md5
      md5: 59a04e062df44655488134f8946c638a
      size: 1287
    outs:
    - path: .env_mlops_sake
      hash: md5
      md5: ebda30d4cd6c48f6ac57daa41bbb423d
      size: 3272
    - path: .env_plantUML
      hash: md5
      md5: 6bbc1d40608aa5d1637aeb5d1d93d4d3
      size: 3818
  start_docker:
    cmd: source scripts/docker_clean_dangling_images.sh && docker-compose stop &&
      docker-compose up --build -d && date > dockers_started.txt
    deps:
    - path: .env_mlops_sake
      hash: md5
      md5: 776596d2261abe1b4b67767b11fd5029
      size: 3145
    - path: docker-compose.yaml
      hash: md5
      md5: f37199e1292c0ab4441dc2be39068619
      size: 5500
    outs:
    - path: dockers_started.txt
      hash: md5
      md5: b0064df85e6e6daf47115f32ff29f6c6
      size: 29
  start_dockers:
    cmd: source scripts/docker_clean_dangling_images.sh && docker-compose stop &&
      docker-compose up --build -d && date > dockers_started.txt
    deps:
    - path: .env_mlops_sake
      hash: md5
      md5: ebda30d4cd6c48f6ac57daa41bbb423d
      size: 3272
    - path: docker-compose.yaml
      hash: md5
      md5: 80beee7cef45289a76589c16835297e4
      size: 5430
    outs:
    - path: dockers_started.txt
      hash: md5
      md5: cc72867581029d08025a87c527baf24e
      size: 29
