schema: '2.0'
stages:
  structure_raw:
    cmd: python3 src/data/structure_raw.py
    deps:
    - path: data/raw/
      hash: md5
      md5: 6c3622ff98294a528208aece1e7ede8b.dir
      size: 21954635
      nfiles: 183
    - path: data/working_dataset.csv
      hash: md5
      md5: 02086bf6991f01344eccc4aba1935f1e
      size: 4542
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    - path: src/data/structure_raw.py
      hash: md5
      md5: 913a67d14af30d19176c2eeb4a6f6c88
      size: 3467
    outs:
    - path: data/raw_per_classes/
      hash: md5
      md5: f649d221b593c31f1d3a432966a87f42.dir
      size: 21954635
      nfiles: 183
  ingest:
    cmd: curl -X "GET" "http://localhost:8907/ingest"
    deps:
    - path: data/raw_per_classes/
      hash: md5
      md5: f649d221b593c31f1d3a432966a87f42.dir
      size: 21954635
      nfiles: 183
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    outs:
    - path: data/ocr_raw_per_classes/
      hash: md5
      md5: 282ccc0bd84fe7e4ed4efbb5ec7c11a3.dir
      size: 172696
      nfiles: 180
  clean:
    cmd: curl -X "GET" "http://localhost:8907/clean"
    deps:
    - path: data/ocr_raw_per_classes/
      hash: md5
      md5: 282ccc0bd84fe7e4ed4efbb5ec7c11a3.dir
      size: 172696
      nfiles: 180
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    outs:
    - path: data/cleaned_per_classes/
      hash: md5
      md5: 791f3bc2369a28528a5d1b500d472a5b.dir
      size: 112143
      nfiles: 3
  preprocessing:
    cmd: curl -X "GET" "http://localhost:8904/process"
    deps:
    - path: data/cleaned_per_classes/
      hash: md5
      md5: 791f3bc2369a28528a5d1b500d472a5b.dir
      size: 112143
      nfiles: 3
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    outs:
    - path: data/processed
      hash: md5
      md5: f3c63e1d15010ce43ba29d9cd73a7de9.dir
      size: 3094842
      nfiles: 4
    - path: models/vectorizers
      hash: md5
      md5: c5ac962d43a7d392aa03247fbbc77d89.dir
      size: 2529738
      nfiles: 1
  train:
    cmd: curl -X "GET" "http://localhost:8905/train"
    deps:
    - path: data/processed/train/
      hash: md5
      md5: da295e9351c2b66a2c2365ec0739b893.dir
      size: 2532117
      nfiles: 2
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    outs:
    - path: models/train/
      hash: md5
      md5: 3605b55fed3b2e0ed4be220f0dc500be.dir
      size: 1682517
      nfiles: 1
  eval:
    cmd: curl -X "GET" "http://localhost:8906/eval"
    deps:
    - path: data/processed/test/
      hash: md5
      md5: 4dd7532eb3123d48c768dcf241009168.dir
      size: 562725
      nfiles: 2
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
    - path: models/train/
      hash: md5
      md5: 3605b55fed3b2e0ed4be220f0dc500be.dir
      size: 1682517
      nfiles: 1
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    outs:
    - path: metrics/confusion_matrix.json
      hash: md5
      md5: 7df4032c6936a0a9979c09a5478e9bc0
      size: 75
    - path: metrics/scores.json
      hash: md5
      md5: d754a8171cd384e0bd4e54afd8f70923
      size: 399
  env_mlops_sake:
    cmd: python3 src/config_transform_as_env.py && python src/smart_merge_.env_.env_mlops_sake.py
    deps:
    - path: params.yaml
      hash: md5
      md5: 1d84b040adbb1d36fae3bf71feca5084
      size: 1884
    - path: src/config_transform_as_env.py
      hash: md5
      md5: d037bfba3fe02aae00df095cdcabde25
      size: 2745
    - path: src/smart_merge_.env_.env_mlops_sake.py
      hash: md5
      md5: b414ccb85a884e0568fe5ffbb3d3c766
      size: 1216
  start_docker:
    cmd: source scripts/docker_clean_dangling_images.sh && docker-compose stop &&
      docker-compose up --build -d && date > dockers_started.txt
    deps:
    - path: .env_mlops_sake
      hash: md5
      md5: 4c2c3e1cd51627865dc83bdfbab63639
      size: 1875
    - path: docker-compose.yaml
      hash: md5
      md5: a1e85c66483987edad75a533033ae0cd
      size: 5336
    outs:
    - path: dockers_started.txt
      hash: md5
      md5: 1ec9ef8c99cd189f20991732a73cb0f2
      size: 29
